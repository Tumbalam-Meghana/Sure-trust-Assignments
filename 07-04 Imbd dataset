{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "3_Fv7J8jTBlu"
   },
   "source": [
    "## You have been hired by a rookie movie producer to help him decide what type of movies to produce and which actors to cast. You have to back your recommendations based on thorough analysis of the data he shared with you which has the list of 3000 movies and the corresponding details.\n",
    "\n",
    "## As a data scientist, you have to first explore the data and check its sanity.\n",
    "\n",
    "## Further, you have to answer the following questions:\n",
    "1. ### <b> Which movie made the highest profit? Who were its producer and director? Identify the actors in that film.</b>\n",
    "2. ### <b>This data has information about movies made in different languages. Which language has the highest average ROI (return on investment)? </b>\n",
    "3. ### <b> Find out the unique genres of movies in this dataset.</b>\n",
    "4. ### <b> Make a table of all the producers and directors of each movie. Find the top 3 producers who have produced movies with the highest average RoI? </b>\n",
    "5. ### <b> Which actor has acted in the most number of movies? Deep dive into the movies, genres and profits corresponding to this actor. </b>\n",
    "6. ### <b>Top 3 directors prefer which actors the most? </b>\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "Fx8CVjtZW_BF"
   },
   "source": [
    "# Data Exploration"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "id": "vq7iMfybnKNP"
   },
   "outputs": [],
   "source": [
    "#Import required packages\n",
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "id": "mZ4nse2rDm-l"
   },
   "outputs": [],
   "source": [
    "imdb_df =pd.read_csv(r\"C:\\Users\\HP\\OneDrive\\Desktop\\pythonprograms\\datasets\\imdb_data.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>belongs_to_collection</th>\n",
       "      <th>budget</th>\n",
       "      <th>genres</th>\n",
       "      <th>homepage</th>\n",
       "      <th>imdb_id</th>\n",
       "      <th>original_language</th>\n",
       "      <th>original_title</th>\n",
       "      <th>overview</th>\n",
       "      <th>popularity</th>\n",
       "      <th>...</th>\n",
       "      <th>release_date</th>\n",
       "      <th>runtime</th>\n",
       "      <th>spoken_languages</th>\n",
       "      <th>status</th>\n",
       "      <th>tagline</th>\n",
       "      <th>title</th>\n",
       "      <th>Keywords</th>\n",
       "      <th>cast</th>\n",
       "      <th>crew</th>\n",
       "      <th>revenue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>[{'id': 313576, 'name': 'Hot Tub Time Machine ...</td>\n",
       "      <td>14000000</td>\n",
       "      <td>[{'id': 35, 'name': 'Comedy'}]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>tt2637294</td>\n",
       "      <td>en</td>\n",
       "      <td>Hot Tub Time Machine 2</td>\n",
       "      <td>When Lou, who has become the \"father of the In...</td>\n",
       "      <td>6.575393</td>\n",
       "      <td>...</td>\n",
       "      <td>2/20/15</td>\n",
       "      <td>93.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>The Laws of Space and Time are About to be Vio...</td>\n",
       "      <td>Hot Tub Time Machine 2</td>\n",
       "      <td>[{'id': 4379, 'name': 'time travel'}, {'id': 9...</td>\n",
       "      <td>[{'cast_id': 4, 'character': 'Lou', 'credit_id...</td>\n",
       "      <td>[{'credit_id': '59ac067c92514107af02c8c8', 'de...</td>\n",
       "      <td>12314651</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>[{'id': 107674, 'name': 'The Princess Diaries ...</td>\n",
       "      <td>40000000</td>\n",
       "      <td>[{'id': 35, 'name': 'Comedy'}, {'id': 18, 'nam...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>tt0368933</td>\n",
       "      <td>en</td>\n",
       "      <td>The Princess Diaries 2: Royal Engagement</td>\n",
       "      <td>Mia Thermopolis is now a college graduate and ...</td>\n",
       "      <td>8.248895</td>\n",
       "      <td>...</td>\n",
       "      <td>8/6/04</td>\n",
       "      <td>113.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>It can take a lifetime to find true love; she'...</td>\n",
       "      <td>The Princess Diaries 2: Royal Engagement</td>\n",
       "      <td>[{'id': 2505, 'name': 'coronation'}, {'id': 42...</td>\n",
       "      <td>[{'cast_id': 1, 'character': 'Mia Thermopolis'...</td>\n",
       "      <td>[{'credit_id': '52fe43fe9251416c7502563d', 'de...</td>\n",
       "      <td>95149435</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3300000</td>\n",
       "      <td>[{'id': 18, 'name': 'Drama'}]</td>\n",
       "      <td>http://sonyclassics.com/whiplash/</td>\n",
       "      <td>tt2582802</td>\n",
       "      <td>en</td>\n",
       "      <td>Whiplash</td>\n",
       "      <td>Under the direction of a ruthless instructor, ...</td>\n",
       "      <td>64.299990</td>\n",
       "      <td>...</td>\n",
       "      <td>10/10/14</td>\n",
       "      <td>105.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>The road to greatness can take you to the edge.</td>\n",
       "      <td>Whiplash</td>\n",
       "      <td>[{'id': 1416, 'name': 'jazz'}, {'id': 1523, 'n...</td>\n",
       "      <td>[{'cast_id': 5, 'character': 'Andrew Neimann',...</td>\n",
       "      <td>[{'credit_id': '54d5356ec3a3683ba0000039', 'de...</td>\n",
       "      <td>13092000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1200000</td>\n",
       "      <td>[{'id': 53, 'name': 'Thriller'}, {'id': 18, 'n...</td>\n",
       "      <td>http://kahaanithefilm.com/</td>\n",
       "      <td>tt1821480</td>\n",
       "      <td>hi</td>\n",
       "      <td>Kahaani</td>\n",
       "      <td>Vidya Bagchi (Vidya Balan) arrives in Kolkata ...</td>\n",
       "      <td>3.174936</td>\n",
       "      <td>...</td>\n",
       "      <td>3/9/12</td>\n",
       "      <td>122.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}, {'iso...</td>\n",
       "      <td>Released</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Kahaani</td>\n",
       "      <td>[{'id': 10092, 'name': 'mystery'}, {'id': 1054...</td>\n",
       "      <td>[{'cast_id': 1, 'character': 'Vidya Bagchi', '...</td>\n",
       "      <td>[{'credit_id': '52fe48779251416c9108d6eb', 'de...</td>\n",
       "      <td>16000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>[{'id': 28, 'name': 'Action'}, {'id': 53, 'nam...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>tt1380152</td>\n",
       "      <td>ko</td>\n",
       "      <td>ÎßàÎ¶∞Î≥¥Ïù¥</td>\n",
       "      <td>Marine Boy is the story of a former national s...</td>\n",
       "      <td>1.148070</td>\n",
       "      <td>...</td>\n",
       "      <td>2/5/09</td>\n",
       "      <td>118.0</td>\n",
       "      <td>[{'iso_639_1': 'ko', 'name': 'ÌïúÍµ≠Ïñ¥/Ï°∞ÏÑ†Îßê'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Marine Boy</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[{'cast_id': 3, 'character': 'Chun-soo', 'cred...</td>\n",
       "      <td>[{'credit_id': '52fe464b9251416c75073b43', 'de...</td>\n",
       "      <td>3923970</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2995</th>\n",
       "      <td>2996</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>[{'id': 35, 'name': 'Comedy'}, {'id': 10749, '...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>tt0109403</td>\n",
       "      <td>en</td>\n",
       "      <td>Chasers</td>\n",
       "      <td>Military men Rock Reilly and Eddie Devane are ...</td>\n",
       "      <td>9.853270</td>\n",
       "      <td>...</td>\n",
       "      <td>4/22/94</td>\n",
       "      <td>102.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>It was supposed to be a routine prisoner trans...</td>\n",
       "      <td>Chasers</td>\n",
       "      <td>[{'id': 378, 'name': 'prison'}, {'id': 572, 'n...</td>\n",
       "      <td>[{'cast_id': 2, 'character': 'Rock Reilly', 'c...</td>\n",
       "      <td>[{'credit_id': '52fe4494c3a368484e02ac7d', 'de...</td>\n",
       "      <td>1596687</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2996</th>\n",
       "      <td>2997</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>[{'id': 18, 'name': 'Drama'}, {'id': 10402, 'n...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>tt2364975</td>\n",
       "      <td>sv</td>\n",
       "      <td>Vi √§r b√§st!</td>\n",
       "      <td>Three girls in 1980s Stockholm decide to form ...</td>\n",
       "      <td>3.727996</td>\n",
       "      <td>...</td>\n",
       "      <td>3/28/13</td>\n",
       "      <td>102.0</td>\n",
       "      <td>[{'iso_639_1': 'sv', 'name': 'svenska'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>NaN</td>\n",
       "      <td>We Are the Best!</td>\n",
       "      <td>[{'id': 1192, 'name': 'sweden'}, {'id': 4470, ...</td>\n",
       "      <td>[{'cast_id': 5, 'character': 'Bobo', 'credit_i...</td>\n",
       "      <td>[{'credit_id': '5716b72ac3a3686678012c84', 'de...</td>\n",
       "      <td>180590</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2997</th>\n",
       "      <td>2998</td>\n",
       "      <td>NaN</td>\n",
       "      <td>65000000</td>\n",
       "      <td>[{'id': 80, 'name': 'Crime'}, {'id': 28, 'name...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>tt0116908</td>\n",
       "      <td>en</td>\n",
       "      <td>The Long Kiss Goodnight</td>\n",
       "      <td>Samantha Caine, suburban homemaker, is the ide...</td>\n",
       "      <td>14.482345</td>\n",
       "      <td>...</td>\n",
       "      <td>10/11/96</td>\n",
       "      <td>120.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>What's forgotten is not always gone.</td>\n",
       "      <td>The Long Kiss Goodnight</td>\n",
       "      <td>[{'id': 441, 'name': 'assassination'}, {'id': ...</td>\n",
       "      <td>[{'cast_id': 10, 'character': 'Samantha Caine ...</td>\n",
       "      <td>[{'credit_id': '52fe443a9251416c7502d579', 'de...</td>\n",
       "      <td>89456761</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2998</th>\n",
       "      <td>2999</td>\n",
       "      <td>NaN</td>\n",
       "      <td>42000000</td>\n",
       "      <td>[{'id': 35, 'name': 'Comedy'}, {'id': 10749, '...</td>\n",
       "      <td>http://www.alongcamepolly.com/</td>\n",
       "      <td>tt0343135</td>\n",
       "      <td>en</td>\n",
       "      <td>Along Came Polly</td>\n",
       "      <td>Reuben Feffer is a guy who's spent his entire ...</td>\n",
       "      <td>15.725542</td>\n",
       "      <td>...</td>\n",
       "      <td>1/16/04</td>\n",
       "      <td>90.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>For the most cautious man on Earth, life is ab...</td>\n",
       "      <td>Along Came Polly</td>\n",
       "      <td>[{'id': 966, 'name': 'beach'}, {'id': 2676, 'n...</td>\n",
       "      <td>[{'cast_id': 8, 'character': 'Reuben Feffer', ...</td>\n",
       "      <td>[{'credit_id': '556f817b9251410866000a63', 'de...</td>\n",
       "      <td>171963386</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2999</th>\n",
       "      <td>3000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>35000000</td>\n",
       "      <td>[{'id': 53, 'name': 'Thriller'}, {'id': 28, 'n...</td>\n",
       "      <td>http://www.abductionthefilm.com/</td>\n",
       "      <td>tt1600195</td>\n",
       "      <td>en</td>\n",
       "      <td>Abduction</td>\n",
       "      <td>A young man sets out to uncover the truth abou...</td>\n",
       "      <td>10.512109</td>\n",
       "      <td>...</td>\n",
       "      <td>9/22/11</td>\n",
       "      <td>106.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>They stole his life. He's taking it back.</td>\n",
       "      <td>Abduction</td>\n",
       "      <td>[{'id': 591, 'name': 'cia'}, {'id': 822, 'name...</td>\n",
       "      <td>[{'cast_id': 2, 'character': 'Nathan Harper', ...</td>\n",
       "      <td>[{'credit_id': '5391990d0e0a260fb5001629', 'de...</td>\n",
       "      <td>82087155</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3000 rows √ó 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        id                              belongs_to_collection    budget  \\\n",
       "0        1  [{'id': 313576, 'name': 'Hot Tub Time Machine ...  14000000   \n",
       "1        2  [{'id': 107674, 'name': 'The Princess Diaries ...  40000000   \n",
       "2        3                                                NaN   3300000   \n",
       "3        4                                                NaN   1200000   \n",
       "4        5                                                NaN         0   \n",
       "...    ...                                                ...       ...   \n",
       "2995  2996                                                NaN         0   \n",
       "2996  2997                                                NaN         0   \n",
       "2997  2998                                                NaN  65000000   \n",
       "2998  2999                                                NaN  42000000   \n",
       "2999  3000                                                NaN  35000000   \n",
       "\n",
       "                                                 genres  \\\n",
       "0                        [{'id': 35, 'name': 'Comedy'}]   \n",
       "1     [{'id': 35, 'name': 'Comedy'}, {'id': 18, 'nam...   \n",
       "2                         [{'id': 18, 'name': 'Drama'}]   \n",
       "3     [{'id': 53, 'name': 'Thriller'}, {'id': 18, 'n...   \n",
       "4     [{'id': 28, 'name': 'Action'}, {'id': 53, 'nam...   \n",
       "...                                                 ...   \n",
       "2995  [{'id': 35, 'name': 'Comedy'}, {'id': 10749, '...   \n",
       "2996  [{'id': 18, 'name': 'Drama'}, {'id': 10402, 'n...   \n",
       "2997  [{'id': 80, 'name': 'Crime'}, {'id': 28, 'name...   \n",
       "2998  [{'id': 35, 'name': 'Comedy'}, {'id': 10749, '...   \n",
       "2999  [{'id': 53, 'name': 'Thriller'}, {'id': 28, 'n...   \n",
       "\n",
       "                               homepage    imdb_id original_language  \\\n",
       "0                                   NaN  tt2637294                en   \n",
       "1                                   NaN  tt0368933                en   \n",
       "2     http://sonyclassics.com/whiplash/  tt2582802                en   \n",
       "3            http://kahaanithefilm.com/  tt1821480                hi   \n",
       "4                                   NaN  tt1380152                ko   \n",
       "...                                 ...        ...               ...   \n",
       "2995                                NaN  tt0109403                en   \n",
       "2996                                NaN  tt2364975                sv   \n",
       "2997                                NaN  tt0116908                en   \n",
       "2998     http://www.alongcamepolly.com/  tt0343135                en   \n",
       "2999   http://www.abductionthefilm.com/  tt1600195                en   \n",
       "\n",
       "                                original_title  \\\n",
       "0                       Hot Tub Time Machine 2   \n",
       "1     The Princess Diaries 2: Royal Engagement   \n",
       "2                                     Whiplash   \n",
       "3                                      Kahaani   \n",
       "4                                         ÎßàÎ¶∞Î≥¥Ïù¥   \n",
       "...                                        ...   \n",
       "2995                                   Chasers   \n",
       "2996                               Vi √§r b√§st!   \n",
       "2997                   The Long Kiss Goodnight   \n",
       "2998                          Along Came Polly   \n",
       "2999                                 Abduction   \n",
       "\n",
       "                                               overview  popularity  ...  \\\n",
       "0     When Lou, who has become the \"father of the In...    6.575393  ...   \n",
       "1     Mia Thermopolis is now a college graduate and ...    8.248895  ...   \n",
       "2     Under the direction of a ruthless instructor, ...   64.299990  ...   \n",
       "3     Vidya Bagchi (Vidya Balan) arrives in Kolkata ...    3.174936  ...   \n",
       "4     Marine Boy is the story of a former national s...    1.148070  ...   \n",
       "...                                                 ...         ...  ...   \n",
       "2995  Military men Rock Reilly and Eddie Devane are ...    9.853270  ...   \n",
       "2996  Three girls in 1980s Stockholm decide to form ...    3.727996  ...   \n",
       "2997  Samantha Caine, suburban homemaker, is the ide...   14.482345  ...   \n",
       "2998  Reuben Feffer is a guy who's spent his entire ...   15.725542  ...   \n",
       "2999  A young man sets out to uncover the truth abou...   10.512109  ...   \n",
       "\n",
       "     release_date runtime                                   spoken_languages  \\\n",
       "0         2/20/15    93.0           [{'iso_639_1': 'en', 'name': 'English'}]   \n",
       "1          8/6/04   113.0           [{'iso_639_1': 'en', 'name': 'English'}]   \n",
       "2        10/10/14   105.0           [{'iso_639_1': 'en', 'name': 'English'}]   \n",
       "3          3/9/12   122.0  [{'iso_639_1': 'en', 'name': 'English'}, {'iso...   \n",
       "4          2/5/09   118.0           [{'iso_639_1': 'ko', 'name': 'ÌïúÍµ≠Ïñ¥/Ï°∞ÏÑ†Îßê'}]   \n",
       "...           ...     ...                                                ...   \n",
       "2995      4/22/94   102.0           [{'iso_639_1': 'en', 'name': 'English'}]   \n",
       "2996      3/28/13   102.0           [{'iso_639_1': 'sv', 'name': 'svenska'}]   \n",
       "2997     10/11/96   120.0           [{'iso_639_1': 'en', 'name': 'English'}]   \n",
       "2998      1/16/04    90.0           [{'iso_639_1': 'en', 'name': 'English'}]   \n",
       "2999      9/22/11   106.0           [{'iso_639_1': 'en', 'name': 'English'}]   \n",
       "\n",
       "        status                                            tagline  \\\n",
       "0     Released  The Laws of Space and Time are About to be Vio...   \n",
       "1     Released  It can take a lifetime to find true love; she'...   \n",
       "2     Released    The road to greatness can take you to the edge.   \n",
       "3     Released                                                NaN   \n",
       "4     Released                                                NaN   \n",
       "...        ...                                                ...   \n",
       "2995  Released  It was supposed to be a routine prisoner trans...   \n",
       "2996  Released                                                NaN   \n",
       "2997  Released               What's forgotten is not always gone.   \n",
       "2998  Released  For the most cautious man on Earth, life is ab...   \n",
       "2999  Released          They stole his life. He's taking it back.   \n",
       "\n",
       "                                         title  \\\n",
       "0                       Hot Tub Time Machine 2   \n",
       "1     The Princess Diaries 2: Royal Engagement   \n",
       "2                                     Whiplash   \n",
       "3                                      Kahaani   \n",
       "4                                   Marine Boy   \n",
       "...                                        ...   \n",
       "2995                                   Chasers   \n",
       "2996                          We Are the Best!   \n",
       "2997                   The Long Kiss Goodnight   \n",
       "2998                          Along Came Polly   \n",
       "2999                                 Abduction   \n",
       "\n",
       "                                               Keywords  \\\n",
       "0     [{'id': 4379, 'name': 'time travel'}, {'id': 9...   \n",
       "1     [{'id': 2505, 'name': 'coronation'}, {'id': 42...   \n",
       "2     [{'id': 1416, 'name': 'jazz'}, {'id': 1523, 'n...   \n",
       "3     [{'id': 10092, 'name': 'mystery'}, {'id': 1054...   \n",
       "4                                                   NaN   \n",
       "...                                                 ...   \n",
       "2995  [{'id': 378, 'name': 'prison'}, {'id': 572, 'n...   \n",
       "2996  [{'id': 1192, 'name': 'sweden'}, {'id': 4470, ...   \n",
       "2997  [{'id': 441, 'name': 'assassination'}, {'id': ...   \n",
       "2998  [{'id': 966, 'name': 'beach'}, {'id': 2676, 'n...   \n",
       "2999  [{'id': 591, 'name': 'cia'}, {'id': 822, 'name...   \n",
       "\n",
       "                                                   cast  \\\n",
       "0     [{'cast_id': 4, 'character': 'Lou', 'credit_id...   \n",
       "1     [{'cast_id': 1, 'character': 'Mia Thermopolis'...   \n",
       "2     [{'cast_id': 5, 'character': 'Andrew Neimann',...   \n",
       "3     [{'cast_id': 1, 'character': 'Vidya Bagchi', '...   \n",
       "4     [{'cast_id': 3, 'character': 'Chun-soo', 'cred...   \n",
       "...                                                 ...   \n",
       "2995  [{'cast_id': 2, 'character': 'Rock Reilly', 'c...   \n",
       "2996  [{'cast_id': 5, 'character': 'Bobo', 'credit_i...   \n",
       "2997  [{'cast_id': 10, 'character': 'Samantha Caine ...   \n",
       "2998  [{'cast_id': 8, 'character': 'Reuben Feffer', ...   \n",
       "2999  [{'cast_id': 2, 'character': 'Nathan Harper', ...   \n",
       "\n",
       "                                                   crew    revenue  \n",
       "0     [{'credit_id': '59ac067c92514107af02c8c8', 'de...   12314651  \n",
       "1     [{'credit_id': '52fe43fe9251416c7502563d', 'de...   95149435  \n",
       "2     [{'credit_id': '54d5356ec3a3683ba0000039', 'de...   13092000  \n",
       "3     [{'credit_id': '52fe48779251416c9108d6eb', 'de...   16000000  \n",
       "4     [{'credit_id': '52fe464b9251416c75073b43', 'de...    3923970  \n",
       "...                                                 ...        ...  \n",
       "2995  [{'credit_id': '52fe4494c3a368484e02ac7d', 'de...    1596687  \n",
       "2996  [{'credit_id': '5716b72ac3a3686678012c84', 'de...     180590  \n",
       "2997  [{'credit_id': '52fe443a9251416c7502d579', 'de...   89456761  \n",
       "2998  [{'credit_id': '556f817b9251410866000a63', 'de...  171963386  \n",
       "2999  [{'credit_id': '5391990d0e0a260fb5001629', 'de...   82087155  \n",
       "\n",
       "[3000 rows x 23 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "#print(imdb_df.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0                          [{'id': 35, 'name': 'Comedy'}]\n",
       "1       [{'id': 35, 'name': 'Comedy'}, {'id': 18, 'nam...\n",
       "2                           [{'id': 18, 'name': 'Drama'}]\n",
       "3       [{'id': 53, 'name': 'Thriller'}, {'id': 18, 'n...\n",
       "4       [{'id': 28, 'name': 'Action'}, {'id': 53, 'nam...\n",
       "                              ...                        \n",
       "2995    [{'id': 35, 'name': 'Comedy'}, {'id': 10749, '...\n",
       "2996    [{'id': 18, 'name': 'Drama'}, {'id': 10402, 'n...\n",
       "2997    [{'id': 80, 'name': 'Crime'}, {'id': 28, 'name...\n",
       "2998    [{'id': 35, 'name': 'Comedy'}, {'id': 10749, '...\n",
       "2999    [{'id': 53, 'name': 'Thriller'}, {'id': 28, 'n...\n",
       "Name: genres, Length: 2993, dtype: object"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Columns that are needed\n",
    "colums_needed=['genres','budget','origina1_language','original_title','cast','crew','revenue']\n",
    "#Checking for the null values are present are not\n",
    "df=imdb_df.loc[~imdb_df['genres'].isna(),'genres']\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "str"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(imdb_df.loc[0,'cast'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "def convert_to_list(str):\n",
    "    return eval(str)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "imdb_df['profit']=imdb_df['revenue']-imdb_df['budget']\n",
    "imdb_df['roi']=(imdb_df['profit']/imdb_df['budget'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>belongs_to_collection</th>\n",
       "      <th>budget</th>\n",
       "      <th>genres</th>\n",
       "      <th>homepage</th>\n",
       "      <th>imdb_id</th>\n",
       "      <th>original_language</th>\n",
       "      <th>original_title</th>\n",
       "      <th>overview</th>\n",
       "      <th>popularity</th>\n",
       "      <th>...</th>\n",
       "      <th>spoken_languages</th>\n",
       "      <th>status</th>\n",
       "      <th>tagline</th>\n",
       "      <th>title</th>\n",
       "      <th>Keywords</th>\n",
       "      <th>cast</th>\n",
       "      <th>crew</th>\n",
       "      <th>revenue</th>\n",
       "      <th>profit</th>\n",
       "      <th>roi</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>[{'id': 313576, 'name': 'Hot Tub Time Machine ...</td>\n",
       "      <td>14000000</td>\n",
       "      <td>[{'id': 35, 'name': 'Comedy'}]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>tt2637294</td>\n",
       "      <td>en</td>\n",
       "      <td>Hot Tub Time Machine 2</td>\n",
       "      <td>When Lou, who has become the \"father of the In...</td>\n",
       "      <td>6.575393</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>The Laws of Space and Time are About to be Vio...</td>\n",
       "      <td>Hot Tub Time Machine 2</td>\n",
       "      <td>[{'id': 4379, 'name': 'time travel'}, {'id': 9...</td>\n",
       "      <td>[{'cast_id': 4, 'character': 'Lou', 'credit_id...</td>\n",
       "      <td>[{'credit_id': '59ac067c92514107af02c8c8', 'de...</td>\n",
       "      <td>12314651</td>\n",
       "      <td>-1685349</td>\n",
       "      <td>-0.120382</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>[{'id': 107674, 'name': 'The Princess Diaries ...</td>\n",
       "      <td>40000000</td>\n",
       "      <td>[{'id': 35, 'name': 'Comedy'}, {'id': 18, 'nam...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>tt0368933</td>\n",
       "      <td>en</td>\n",
       "      <td>The Princess Diaries 2: Royal Engagement</td>\n",
       "      <td>Mia Thermopolis is now a college graduate and ...</td>\n",
       "      <td>8.248895</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>It can take a lifetime to find true love; she'...</td>\n",
       "      <td>The Princess Diaries 2: Royal Engagement</td>\n",
       "      <td>[{'id': 2505, 'name': 'coronation'}, {'id': 42...</td>\n",
       "      <td>[{'cast_id': 1, 'character': 'Mia Thermopolis'...</td>\n",
       "      <td>[{'credit_id': '52fe43fe9251416c7502563d', 'de...</td>\n",
       "      <td>95149435</td>\n",
       "      <td>55149435</td>\n",
       "      <td>1.378736</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2 rows √ó 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   id                              belongs_to_collection    budget  \\\n",
       "0   1  [{'id': 313576, 'name': 'Hot Tub Time Machine ...  14000000   \n",
       "1   2  [{'id': 107674, 'name': 'The Princess Diaries ...  40000000   \n",
       "\n",
       "                                              genres homepage    imdb_id  \\\n",
       "0                     [{'id': 35, 'name': 'Comedy'}]      NaN  tt2637294   \n",
       "1  [{'id': 35, 'name': 'Comedy'}, {'id': 18, 'nam...      NaN  tt0368933   \n",
       "\n",
       "  original_language                            original_title  \\\n",
       "0                en                    Hot Tub Time Machine 2   \n",
       "1                en  The Princess Diaries 2: Royal Engagement   \n",
       "\n",
       "                                            overview  popularity  ...  \\\n",
       "0  When Lou, who has become the \"father of the In...    6.575393  ...   \n",
       "1  Mia Thermopolis is now a college graduate and ...    8.248895  ...   \n",
       "\n",
       "                           spoken_languages    status  \\\n",
       "0  [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "1  [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "\n",
       "                                             tagline  \\\n",
       "0  The Laws of Space and Time are About to be Vio...   \n",
       "1  It can take a lifetime to find true love; she'...   \n",
       "\n",
       "                                      title  \\\n",
       "0                    Hot Tub Time Machine 2   \n",
       "1  The Princess Diaries 2: Royal Engagement   \n",
       "\n",
       "                                            Keywords  \\\n",
       "0  [{'id': 4379, 'name': 'time travel'}, {'id': 9...   \n",
       "1  [{'id': 2505, 'name': 'coronation'}, {'id': 42...   \n",
       "\n",
       "                                                cast  \\\n",
       "0  [{'cast_id': 4, 'character': 'Lou', 'credit_id...   \n",
       "1  [{'cast_id': 1, 'character': 'Mia Thermopolis'...   \n",
       "\n",
       "                                                crew   revenue    profit  \\\n",
       "0  [{'credit_id': '59ac067c92514107af02c8c8', 'de...  12314651  -1685349   \n",
       "1  [{'credit_id': '52fe43fe9251416c7502563d', 'de...  95149435  55149435   \n",
       "\n",
       "        roi  \n",
       "0 -0.120382  \n",
       "1  1.378736  \n",
       "\n",
       "[2 rows x 25 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_df.head(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1316249360"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_df['profit'].max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Movie with the highest profit:\n",
      "Title: Furious 7\n",
      "Profit: 1316249360\n"
     ]
    }
   ],
   "source": [
    "# First, check that the 'profit' column exists and is numeric\n",
    "imdb_df['profit'] = pd.to_numeric(imdb_df['profit'], errors='coerce')\n",
    "\n",
    "# Find the index of the row with the maximum profit\n",
    "max_profit_index = imdb_df['profit'].idxmax()\n",
    "\n",
    "# Get the movie's details\n",
    "highest_profit_movie = imdb_df.loc[max_profit_index]\n",
    "\n",
    "# Print the original title and profit\n",
    "print(\"Movie with the highest profit:\")\n",
    "print(\"Title:\", highest_profit_movie['original_title'])\n",
    "print(\"Profit:\", highest_profit_movie['profit'])\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    " 1.Which movie made the highest profit? Who were its producer and director? Identify the actors in that film."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Movie with the highest profit: Furious 7\n",
      "Profit: 1316249360\n",
      "Producer(s): [{'name': 'Universal Pictures', 'id': 33}, {'name': 'Original Film', 'id': 333}, {'name': 'Fuji Television Network', 'id': 3341}, {'name': 'Dentsu', 'id': 6452}, {'name': 'One Race Films', 'id': 7154}, {'name': 'China Film Co.', 'id': 40890}, {'name': 'Qu√©bec Production Services Tax Credit', 'id': 86352}, {'name': 'Media Rights Capital (MRC)', 'id': 86655}, {'name': 'Abu Dhabi Film Commission', 'id': 87857}, {'name': 'Colorado Office of Film, Television & Media', 'id': 87858}]\n",
      "Director: James Wan\n"
     ]
    }
   ],
   "source": [
    "import ast\n",
    "def get_director(crew_str):\n",
    "    try:\n",
    "        crew_list = ast.literal_eval(crew_str)\n",
    "        for member in crew_list:\n",
    "            if member.get('job') == 'Director':\n",
    "                return member.get('name')\n",
    "    except:\n",
    "        return None\n",
    "\n",
    "imdb_df['profit'] = imdb_df['revenue'] - imdb_df['budget']\n",
    "\n",
    "# Find the movie with the highest profit\n",
    "max_profit_movie = imdb_df.loc[imdb_df['profit'].idxmax()]\n",
    "\n",
    "# Extract director name\n",
    "director = get_director(max_profit_movie['crew'])\n",
    "\n",
    "# Print details\n",
    "print(\"Movie with the highest profit:\", max_profit_movie['title'])\n",
    "print(\"Profit:\", max_profit_movie['profit'])\n",
    "print(\"Producer(s):\", max_profit_movie['production_companies'])\n",
    "print(\"Director:\", director)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This data has information about movies made in different languages. Which language has the highest average ROI (return on investment)? "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Language with the highest average ROI: ko\n",
      "Average ROI: 381794.10228078865\n"
     ]
    }
   ],
   "source": [
    "\n",
    "imdb_df = imdb_df[imdb_df['budget'] > 0].copy()\n",
    "# Calculate ROI\n",
    "imdb_df['roi'] = (imdb_df['revenue'] - imdb_df['budget']) / imdb_df['budget']\n",
    "\n",
    "# Group by language and calculate average ROI\n",
    "roi_by_language = imdb_df.groupby('original_language')['roi'].mean().sort_values(ascending=False)\n",
    "\n",
    "# Get the language with highest average ROI\n",
    "top_language = roi_by_language.idxmax()\n",
    "top_language_roi = roi_by_language.max()\n",
    "\n",
    "# Print result\n",
    "print(\"Language with the highest average ROI:\", top_language)\n",
    "print(\"Average ROI:\", top_language_roi)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Find out the unique genres of movies in this dataset.</b>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "üé≠ Unique genres in the dataset:\n",
      "- Action\n",
      "- Adventure\n",
      "- Animation\n",
      "- Comedy\n",
      "- Crime\n",
      "- Documentary\n",
      "- Drama\n",
      "- Family\n",
      "- Fantasy\n",
      "- Foreign\n",
      "- History\n",
      "- Horror\n",
      "- Music\n",
      "- Mystery\n",
      "- Romance\n",
      "- Science Fiction\n",
      "- TV Movie\n",
      "- Thriller\n",
      "- War\n",
      "- Western\n"
     ]
    }
   ],
   "source": [
    "def extract_genres(genre_str):\n",
    "    try:\n",
    "        genres = ast.literal_eval(genre_str)\n",
    "        return [g['name'] for g in genres]\n",
    "    except:\n",
    "        return []\n",
    "\n",
    "# Apply function to the 'genres' column\n",
    "imdb_df['genre_list'] = imdb_df['genres'].apply(extract_genres)\n",
    "\n",
    "# Get all unique genres\n",
    "unique_genres = set([genre for sublist in imdb_df['genre_list'] for genre in sublist])\n",
    "\n",
    "# Print the result\n",
    "print(\"üé≠ Unique genres in the dataset:\")\n",
    "for genre in sorted(unique_genres):\n",
    "    print(\"-\", genre)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "4. ### <b> Make a table of all the producers and directors of each movie. Find the top 3 producers who have produced movies with the highest average RoI? </b>\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "üé¨ Producers and Directors Table:\n",
      "                                   title                                                     producers         directors\n",
      "                  Hot Tub Time Machine 2                                                [Andrew Panay]      [Steve Pink]\n",
      "The Princess Diaries 2: Royal Engagement         [Whitney Houston, Mario Iscovich, Debra Martin Chase]  [Garry Marshall]\n",
      "                                Whiplash [David Lancaster, Michel Litvak, Jason Blum, Helen Estabrook] [Damien Chazelle]\n",
      "                                 Kahaani                                                 [Sujoy Ghosh]     [Sujoy Ghosh]\n",
      "  Pinocchio and the Emperor of the Night                                                            []  [Hal Sutherland]\n",
      "\n",
      "üèÜ Top 3 Producers with Highest Average ROI:\n",
      "    Producer Average ROI\n",
      "  Lee Eun-ha 4197475.625\n",
      "    Jang Jin 4197475.625\n",
      "Ji Sang-yong 4197475.625\n"
     ]
    }
   ],
   "source": [
    "import ast\n",
    "import pandas as pd\n",
    "def extract_people(crew_str, job):\n",
    "    try:\n",
    "        crew_list = ast.literal_eval(crew_str)\n",
    "        return [person['name'] for person in crew_list if person['job'] == job]\n",
    "    except:\n",
    "        return []\n",
    "imdb_df['producers'] = imdb_df['crew'].apply(lambda x: extract_people(x, 'Producer'))\n",
    "imdb_df['directors'] = imdb_df['crew'].apply(lambda x: extract_people(x, 'Director'))\n",
    "prod_dir_table = imdb_df[['title', 'producers', 'directors']]\n",
    "print(\"Producers and Directors Table:\")\n",
    "print(prod_dir_table.head().to_string(index=False))\n",
    "imdb_df['roi'] = (imdb_df['revenue'] - imdb_df['budget']) / imdb_df['budget']\n",
    "producer_roi = imdb_df[['producers', 'roi']].explode('producers')\n",
    "producer_roi = producer_roi.dropna()\n",
    "top_3_producers = producer_roi.groupby('producers')['roi'].mean().sort_values(ascending=False).head(3).reset_index()\n",
    "print(\"\\nüèÜ Top 3 Producers with Highest Average ROI:\")\n",
    "print(top_3_producers.to_string(index=False, header=['Producer', 'Average ROI']))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "5. ### <b> Which actor has acted in the most number of movies? Deep dive into the movies, genres and profits corresponding to this actor. </b>\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "üé≠ Most frequent actor: Samuel L. Jackson (25 movies)\n",
      "\n",
      " Movies with Samuel L. Jackson\n",
      "                                             title  \\\n",
      "29                                  Changing Lanes   \n",
      "47                               The Hateful Eight   \n",
      "642                              Coming to America   \n",
      "689   Star Wars: Episode III - Revenge of the Sith   \n",
      "1126                                  The Avengers   \n",
      "1181                                        Jumper   \n",
      "1426                                         Shaft   \n",
      "1482                             Snakes on a Plane   \n",
      "1717                                       RoboCop   \n",
      "1735                                 Jurassic Park   \n",
      "1818  Star Wars: Episode II - Attack of the Clones   \n",
      "1861           Captain America: The Winter Soldier   \n",
      "1916                                  Jackie Brown   \n",
      "1970                                      Big Game   \n",
      "2214                              Black Snake Moan   \n",
      "2243                                   Sea of Love   \n",
      "2424                                 Deep Blue Sea   \n",
      "2544                                         Basic   \n",
      "2739                               The Incredibles   \n",
      "2770                       Avengers: Age of Ultron   \n",
      "2782                                  Out of Sight   \n",
      "2898                                 Patriot Games   \n",
      "2984                                      S.W.A.T.   \n",
      "2985                                   Freedomland   \n",
      "2997                       The Long Kiss Goodnight   \n",
      "\n",
      "                                    genres_list      profit  \n",
      "29         [Action, Adventure, Crime, Thriller]    49935764  \n",
      "47             [Crime, Drama, Mystery, Western]   111760117  \n",
      "642                           [Comedy, Romance]   249752301  \n",
      "689        [Science Fiction, Adventure, Action]   737000000  \n",
      "1126       [Science Fiction, Action, Adventure]  1299557910  \n",
      "1181      [Adventure, Fantasy, Science Fiction]   137231186  \n",
      "1426       [Action, Adventure, Crime, Thriller]    61196498  \n",
      "1482          [Action, Crime, Horror, Thriller]    29022014  \n",
      "1717                  [Action, Science Fiction]   122688965  \n",
      "1735               [Adventure, Science Fiction]   857100000  \n",
      "1818       [Adventure, Action, Science Fiction]   529398328  \n",
      "1861       [Action, Adventure, Science Fiction]   544766572  \n",
      "1916                   [Comedy, Crime, Romance]    27673162  \n",
      "1970              [Action, Adventure, Thriller]    -1000000  \n",
      "2214                                    [Drama]    -4096154  \n",
      "2243                    [Drama, Crime, Mystery]    91879513  \n",
      "2424        [Action, Science Fiction, Thriller]    13648228  \n",
      "2544  [Action, Drama, Mystery, Thriller, Crime]    -7207439  \n",
      "2739     [Action, Adventure, Animation, Family]   539442092  \n",
      "2770       [Action, Adventure, Science Fiction]  1125403694  \n",
      "2782                   [Romance, Comedy, Crime]    29745568  \n",
      "2898           [Drama, Action, Thriller, Crime]   133051587  \n",
      "2984                  [Action, Thriller, Crime]    36643346  \n",
      "2985          [Drama, Thriller, Crime, Mystery]   -23009372  \n",
      "2997         [Crime, Action, Mystery, Thriller]    24456761  \n",
      "Total movies: 25\n",
      "Average profit: $268,641,625.64\n"
     ]
    }
   ],
   "source": [
    "actor_count = {}\n",
    "for cast in imdb_df['cast']:\n",
    "    try:\n",
    "        cast_list = eval(cast)\n",
    "        for actor in cast_list:\n",
    "            name = actor['name']\n",
    "            if name in actor_count:\n",
    "                actor_count[name] += 1\n",
    "            else:\n",
    "                actor_count[name] = 1\n",
    "    except:\n",
    "        continue\n",
    "top_actor = max(actor_count, key=actor_count.get)\n",
    "print(f\"üé≠ Most frequent actor: {top_actor} ({actor_count[top_actor]} movies)\")\n",
    "\n",
    "# Step 3: Get all movies with this actor\n",
    "def is_top_actor_in_movie(cast_str):\n",
    "    try:\n",
    "        return any(actor['name'] == top_actor for actor in eval(cast_str))\n",
    "    except:\n",
    "        return False\n",
    "top_actor_movies = imdb_df[imdb_df['cast'].apply(is_top_actor_in_movie)].copy()\n",
    "def get_genres(genre_str):\n",
    "    try:\n",
    "        return [g['name'] for g in eval(genre_str)]\n",
    "    except:\n",
    "        return []\n",
    "top_actor_movies['genres_list'] = top_actor_movies['genres'].apply(get_genres)\n",
    "# Step 5: Show result\n",
    "print(\"\\n Movies with\", top_actor)\n",
    "print(top_actor_movies[['title', 'genres_list', 'profit']])\n",
    "print(\"Total movies:\", len(top_actor_movies))\n",
    "print(\"Average profit: ${:,.2f}\".format(top_actor_movies['profit'].mean()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "üé¨ Actor with most movies: Samuel L. Jackson\n",
      "\n",
      "Movies, genres, and profits for Samuel L. Jackson\n",
      "                                             title  \\\n",
      "29                                  Changing Lanes   \n",
      "47                               The Hateful Eight   \n",
      "642                              Coming to America   \n",
      "689   Star Wars: Episode III - Revenge of the Sith   \n",
      "1126                                  The Avengers   \n",
      "1181                                        Jumper   \n",
      "1426                                         Shaft   \n",
      "1482                             Snakes on a Plane   \n",
      "1717                                       RoboCop   \n",
      "1735                                 Jurassic Park   \n",
      "1818  Star Wars: Episode II - Attack of the Clones   \n",
      "1861           Captain America: The Winter Soldier   \n",
      "1916                                  Jackie Brown   \n",
      "1970                                      Big Game   \n",
      "2214                              Black Snake Moan   \n",
      "2243                                   Sea of Love   \n",
      "2424                                 Deep Blue Sea   \n",
      "2544                                         Basic   \n",
      "2739                               The Incredibles   \n",
      "2770                       Avengers: Age of Ultron   \n",
      "2782                                  Out of Sight   \n",
      "2898                                 Patriot Games   \n",
      "2984                                      S.W.A.T.   \n",
      "2985                                   Freedomland   \n",
      "2997                       The Long Kiss Goodnight   \n",
      "\n",
      "                                     genre_list      profit  \n",
      "29         [Action, Adventure, Crime, Thriller]    49935764  \n",
      "47             [Crime, Drama, Mystery, Western]   111760117  \n",
      "642                           [Comedy, Romance]   249752301  \n",
      "689        [Science Fiction, Adventure, Action]   737000000  \n",
      "1126       [Science Fiction, Action, Adventure]  1299557910  \n",
      "1181      [Adventure, Fantasy, Science Fiction]   137231186  \n",
      "1426       [Action, Adventure, Crime, Thriller]    61196498  \n",
      "1482          [Action, Crime, Horror, Thriller]    29022014  \n",
      "1717                  [Action, Science Fiction]   122688965  \n",
      "1735               [Adventure, Science Fiction]   857100000  \n",
      "1818       [Adventure, Action, Science Fiction]   529398328  \n",
      "1861       [Action, Adventure, Science Fiction]   544766572  \n",
      "1916                   [Comedy, Crime, Romance]    27673162  \n",
      "1970              [Action, Adventure, Thriller]    -1000000  \n",
      "2214                                    [Drama]    -4096154  \n",
      "2243                    [Drama, Crime, Mystery]    91879513  \n",
      "2424        [Action, Science Fiction, Thriller]    13648228  \n",
      "2544  [Action, Drama, Mystery, Thriller, Crime]    -7207439  \n",
      "2739     [Action, Adventure, Animation, Family]   539442092  \n",
      "2770       [Action, Adventure, Science Fiction]  1125403694  \n",
      "2782                   [Romance, Comedy, Crime]    29745568  \n",
      "2898           [Drama, Action, Thriller, Crime]   133051587  \n",
      "2984                  [Action, Thriller, Crime]    36643346  \n",
      "2985          [Drama, Thriller, Crime, Mystery]   -23009372  \n",
      "2997         [Crime, Action, Mystery, Thriller]    24456761  \n"
     ]
    }
   ],
   "source": [
    "import ast\n",
    "\n",
    "# Function to extract actor names\n",
    "def extract_actors(cast_str):\n",
    "    try:\n",
    "        cast_list = ast.literal_eval(cast_str)\n",
    "        return [actor['name'] for actor in cast_list]\n",
    "    except:\n",
    "        return []\n",
    "\n",
    "# Apply function to extract actor names\n",
    "imdb_df['actor_list'] = imdb_df['cast'].apply(extract_actors)\n",
    "\n",
    "# Explode to get one row per actor\n",
    "actor_df = imdb_df.explode('actor_list')\n",
    "\n",
    "# Find the actor with most movies\n",
    "top_actor = actor_df['actor_list'].value_counts().idxmax()\n",
    "print(\"üé¨ Actor with most movies:\", top_actor)\n",
    "\n",
    "# Filter all rows for this actor\n",
    "top_actor_movies = actor_df[actor_df['actor_list'] == top_actor][['title', 'genre_list', 'profit']]\n",
    "\n",
    "# Display result\n",
    "print(\"\\nMovies, genres, and profits for\", top_actor)\n",
    "print(top_actor_movies)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "6. ### <b>Top 3 directors prefer which actors the most? </b>\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Top 3 directors: ['Steven Spielberg', 'Todd Phillips', 'Ron Howard']\n",
      "\n",
      " Director: Steven Spielberg\n",
      "Most preferred actors:\n",
      "actor_list\n",
      "Harrison Ford       3\n",
      "Sasha Spielberg     2\n",
      "Steven Spielberg    2\n",
      "Name: count, dtype: int64\n",
      "\n",
      " Director: Todd Phillips\n",
      "Most preferred actors:\n",
      "actor_list\n",
      "Zach Galifianakis    3\n",
      "Juliette Lewis       3\n",
      "Matt Walsh           3\n",
      "Name: count, dtype: int64\n",
      "\n",
      " Director: Ron Howard\n",
      "Most preferred actors:\n",
      "actor_list\n",
      "Clint Howard     4\n",
      "Rance Howard     3\n",
      "Russell Crowe    2\n",
      "Name: count, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "def extract_directors(crew_str):\n",
    "    try:\n",
    "        crew_list = ast.literal_eval(crew_str)\n",
    "        return [member['name'] for member in crew_list if member['job'] == 'Director']\n",
    "    except:\n",
    "        return []\n",
    "imdb_df['director_list'] = imdb_df['crew'].apply(extract_directors)\n",
    "dir_actor_df = imdb_df.explode('director_list').explode('actor_list')\n",
    "dir_actor_df = dir_actor_df.dropna(subset=['director_list', 'actor_list'])\n",
    "top_3_directors = dir_actor_df['director_list'].value_counts().head(3).index.tolist()\n",
    "print(\"Top 3 directors:\", top_3_directors)\n",
    "for director in top_3_directors:\n",
    "    actors = dir_actor_df[dir_actor_df['director_list'] == director]['actor_list'].value_counts().head(3)\n",
    "    print(f\"\\n Director: {director}\")\n",
    "    print(\"Most preferred actors:\")\n",
    "    print(actors)\n"
   ]
  }
 ],
 "metadata": {
  "colab": {
   "provenance": []
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
